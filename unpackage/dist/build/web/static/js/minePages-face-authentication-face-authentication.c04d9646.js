(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["minePages-face-authentication-face-authentication"],{"03ee":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return n}));var n={tnNavBar:e("aa86").default},i=function(){var t=this.$createElement,a=this._self._c||t;return a("v-uni-view",{staticClass:"template-avatar tn-safe-area-inset-bottom"},[a("tn-nav-bar",{attrs:{fixed:!0}},[this._v("人脸认证")]),a("v-uni-view",[a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"camera-box"},[a("v-uni-view",{staticClass:"camera-bg-box"},[a("v-uni-camera",{staticClass:"camera",attrs:{"device-position":"front",flash:"off",resolution:"low"}})],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:this.tipsText,expression:"tipsText"}],staticClass:"camera-tip"},[this._v(this._s(this.tipsText))])],1)],1)],1)],1)},o=[]},"0d0c":function(t,a,e){"use strict";var n=e("9d7d"),i=e.n(n);i.a},1992:function(t,a,e){var n=e("a852");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("4f06").default;i("198d12fd",n,!0,{sourceMap:!1,shadowMode:!1})},"1faf":function(t,a,e){"use strict";e("7a82");var n=e("ee27").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=n(e("f07e")),o=n(e("c964"));e("a9e3");var s=n(e("9edb")),r={name:"tn-nav-bar",mixins:[s.default],props:{zIndex:{type:Number,default:0},height:{type:Number,default:0},unit:{type:String,default:"px"},isBack:{type:Boolean,default:!0},backIcon:{type:String,default:"left"},backTitle:{type:String,default:"返回"},alpha:{type:Boolean,default:!1},fixed:{type:Boolean,default:!0},bottomShadow:{type:Boolean,default:!0},customBack:{type:Boolean,default:!1},beforeBack:{type:Function,default:null}},computed:{navBarStyle:function(){var t={};return t.height=0===this.height?this.customBarHeight+this.unit:this.height+this.unit,this.fixed&&(t.position="fixed"),t.zIndex=this.elZIndex,t},barClass:function(){var t="";return this.backgroundColorClass&&(t+=" ".concat(this.backgroundColorClass)),this.fontColorClass&&(t+="".concat(this.fontColorClass)),this.fixed&&(t+=" tn-custom-nav-bar__bar--fixed"),this.alpha&&(t+=" tn-custom-nav-bar__bar--alpha"),this.bottomShadow&&(t+=" tn-custom-nav-bar__bar--bottom-shadow"),t},barStyle:function(){var t={};return t.height=0===this.height?this.customBarHeight+this.unit:this.height+this.unit,this.fixed&&(t.paddingTop=this.statusBarHeight+"px"),this.backgroundColorClass||(t.backgroundColor=""!==this.backgroundColor?this.backgroundColor:"#FFFFFF"),!this.fontColorClass&&this.fontColor&&(t.color=this.fontColor),t.zIndex=this.elZIndex,t},contentStyle:function(){var t={};if(t.top=this.fixed?this.statusBarHeight+"px":"0px",t.height=0===this.height?this.customBarHeight-this.statusBarHeight+this.unit:this.height+this.unit,t.lineHeight=t.height,this.isBack)if(this.customBack){var a=2*(this.customBackStyleInfo.width+this.customBackStyleInfo.left);t.width="calc(100% - ".concat(a,"px)")}else t.width="calc(100% - 340rpx)";else t.width="100%";return t},elZIndex:function(){return this.zIndex?this.zIndex:this.$t.zIndex.navbar}},data:function(){return{statusBarHeight:0,customBarHeight:0,customBackStyleInfo:{width:86,height:32,left:15}}},mounted:function(){this.updateNavBarInfo()},created:function(){},methods:{updateNavBarInfo:function(){var t=this;return(0,o.default)((0,i.default)().mark((function a(){var e,n,o;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t.vuex_custom_bar_height,n=t.vuex_status_bar_height,e){a.next=15;break}return a.prev=3,a.next=6,t.$t.updateCustomBar();case 6:o=a.sent,e=o.customBarHeight,n=o.statusBarHeight,a.next=15;break;case 11:return a.prev=11,a.t0=a["catch"](3),setTimeout((function(){t.updateNavBarInfo()}),10),a.abrupt("return");case 15:t&&t.$t.vuex("vuex_status_bar_height",n),t&&t.$t.vuex("vuex_custom_bar_height",e),t.customBarHeight=e,t.statusBarHeight=n;case 19:case"end":return a.stop()}}),a,null,[[3,11]])})))()},handlerBack:function(){var t=this;return(0,o.default)((0,i.default)().mark((function a(){var e;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.beforeBack||"function"!==typeof t.beforeBack){a.next=10;break}if(e=t.beforeBack.bind(t.$t.$parent.call(t))(),!e||"function"!==typeof e.then){a.next=7;break}return a.next=5,e.then((function(a){t.navBack()})).catch((function(t){}));case 5:a.next=8;break;case 7:!0===e&&t.navBack();case 8:a.next=11;break;case 10:t.navBack();case 11:case"end":return a.stop()}}),a)})))()},navBack:function(){var t=getCurrentPages();if(t&&t.length>0){var a=t[0];1!=t.length||a.route&&"pages/index/index"==a.route?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})}else uni.reLaunch({url:"/pages/index/index"})}}};a.default=r},"273f":function(t,a,e){"use strict";e("7a82"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n={data:function(){return{tipsText:"",index:0}},onLoad:function(t){this.index=t.index,this.initData()},methods:{initData:function(){var t=this;wx.initFaceDetect(),t.cameraEngine=wx.createCameraContext();var a=t.cameraEngine.onCameraFrame((function(e){wx.faceDetect({frameBuffer:e.data,width:e.width,height:e.height,enablePoint:!0,enableConf:!0,enableAngle:!0,enableMultiFace:!0,success:function(n){var i=n.faceInfo[0];if(-1!=n.x&&-1!=n.y||(t.tipsText="请将人脸放入取景框中",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/e37ef752-539b-49b7-94ea-1720f70fd390.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)),n.faceInfo.length>1)t.tipsText="请保证只有一个人";else{var o=i.angleArray,s=o.pitch,r=o.roll,c=o.yaw;if(Math.abs(s)>=.5||Math.abs(r)>=.5||Math.abs(c)>=.5)t.tipsText="请平视摄像头";else if(i.x<(e.width-150)/2||i.x>(e.width-150)/2+150||i.y<(e.height-150)/2||i.y>(e.height-150)/2+150)t.tipsText="请将人脸对准中心位置",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/39c7a4ca-6697-471e-872b-581b58dcd92c.mp3"),a.stop(),setTimeout((function(){a.start()}),2200);else{if(!(i.confArray.global<=.8||i.confArray.leftEye<=.8||i.confArray.mouth<=.8||i.confArray.nose<=.8||i.confArray.rightEye<=.8))return a.stop(),t.tipsText="即将拍照，请保持！",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/6d86c4b4-2d48-4eb8-900e-e5b2f7660f0f.mp3"),void setTimeout((function(){t.handleTakePhotoClick()}),3e3);t.tipsText="请勿遮挡五官",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/45edf2b9-5363-478b-9a2e-dc5cd6307596.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)}}},fail:function(e){-1==e.x||-1==e.y?(t.tipsText="请将人脸放入取景框中",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/e37ef752-539b-49b7-94ea-1720f70fd390.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)):t.tipsText=e.errMsg||"网络错误，请退出页面重试"}})}));a.start()},handleTakePhotoClick:function(){var t=this;this.tipsText="人脸正在上传...",this.cameraEngine.takePhoto({quality:"low",success:function(a){var e=a.tempImagePath;uni.uploadFile({url:"https://www.wangzh.work/upload",filePath:e,name:"file",success:function(a){var e=JSON.parse(a.data).data,n={imageUrl:e};uni.$http.post("/face/addFaceAuthenticationInfo",n),t.tipsText="人脸认证成功",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/9e06868c-95f6-401d-bc36-f4b5bd5282ee.mp3"),setTimeout((function(){uni.navigateBack()}),2e3)}})}}),uni.getSetting({success:function(a){a.authSetting["scope.camera"]||(t.isAuthCamera=!1,uni.openSetting({success:function(a){a.authSetting["scope.camera"]&&(t.isAuthCamera=!0)}}))}})}}};a.default=n},3806:function(t,a,e){"use strict";e.r(a);var n=e("273f"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},"9d7d":function(t,a,e){var n=e("d1a0");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("4f06").default;i("8fc35a4a",n,!0,{sourceMap:!1,shadowMode:!1})},"9edb":function(t,a,e){e("a9e3"),t.exports={data:function(){},props:{backgroundColor:{type:String,default:""},fontColor:{type:String,default:""},fontSize:{type:Number,default:0},fontUnit:{type:String,default:"rpx"}},computed:{backgroundColorStyle:function(){return this.$t.color.getBackgroundColorStyle(this.backgroundColor)},backgroundColorClass:function(){return this.$t.color.getBackgroundColorInternalClass(this.backgroundColor)},fontColorStyle:function(){return this.$t.color.getFontColorStyle(this.fontColor)},fontColorClass:function(){return this.$t.color.getFontColorInternalClass(this.fontColor)},fontSizeStyle:function(){return this.$t.string.getLengthUnitValue(this.fontSize,this.fontUnit)}},methods:{}}},a76f:function(t,a,e){"use strict";e.r(a);var n=e("03ee"),i=e("3806");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("0d0c");var s=e("f0c5"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"66d41d42",null,!1,n["a"],void 0);a["default"]=r.exports},a852:function(t,a,e){var n=e("24fb");a=n(!1),a.push([t.i,'@charset "UTF-8";\n/**\n * 下方引入的为Tuniao UI的集成样式文件，为scss预处理器，其中包含了一些"tn-"开头的自定义变量\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\n * Tuniao UI自定义的css类名和scss变量，均以"tn-"开头，不会造成冲突，请放心使用 \n */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.tn-custom-nav-bar[data-v-1863a3a8]{display:block;position:relative}.tn-custom-nav-bar__bar[data-v-1863a3a8]{display:flex;position:relative;align-items:center;min-height:%?100?%;justify-content:space-between;min-height:0;box-shadow:%?0?% %?0?% %?0?%;z-index:9999}.tn-custom-nav-bar__bar--fixed[data-v-1863a3a8]{position:fixed;width:100%;top:0}.tn-custom-nav-bar__bar--alpha[data-v-1863a3a8]{background:transparent!important;box-shadow:none!important}.tn-custom-nav-bar__bar--bottom-shadow[data-v-1863a3a8]{box-shadow:%?0?% %?0?% %?80?% %?0?% rgba(0,0,0,.05)}.tn-custom-nav-bar__bar__action[data-v-1863a3a8]{display:flex;align-items:center;height:100%;justify-content:center;max-width:100%}.tn-custom-nav-bar__bar__action--nav-back[data-v-1863a3a8]{\n  /* position: absolute; */\n  /* top: 50%; */\n  /* left: 20rpx; */\n  /* margin-top: -15rpx; */padding:%?20?%;font-size:%?38?%;line-height:100%}.tn-custom-nav-bar__bar__action--nav-back-text[data-v-1863a3a8]{padding:%?20?% %?20?% %?20?% %?0?%}.tn-custom-nav-bar__bar__content[data-v-1863a3a8]{position:absolute;text-align:center;left:0;right:0;bottom:0;margin:auto;font-size:%?32?%;cursor:none;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}',""]),t.exports=a},a884:function(t,a,e){"use strict";var n=e("1992"),i=e.n(n);i.a},aa86:function(t,a,e){"use strict";e.r(a);var n=e("ea6c"),i=e("b1ec");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("a884");var s=e("f0c5"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"1863a3a8",null,!1,n["a"],void 0);a["default"]=r.exports},b1ec:function(t,a,e){"use strict";e.r(a);var n=e("1faf"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},d1a0:function(t,a,e){var n=e("24fb");a=n(!1),a.push([t.i,'@charset "UTF-8";\n/**\n * 下方引入的为Tuniao UI的集成样式文件，为scss预处理器，其中包含了一些"tn-"开头的自定义变量\n * 使用的时候，请将下面的一行复制到您的uniapp项目根目录的uni.scss中即可\n * Tuniao UI自定义的css类名和scss变量，均以"tn-"开头，不会造成冲突，请放心使用 \n */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.content[data-v-66d41d42]{position:absolute;top:0;right:0;bottom:0;left:0}.content .camera-box[data-v-66d41d42]{position:relative;width:100%;height:100%}.content .camera-bg-box[data-v-66d41d42]{position:relative;width:100%;height:100%;overflow:hidden}.content .camera-bg-box[data-v-66d41d42]::after{content:"";position:absolute;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);border-radius:100%;width:%?600?%;height:%?600?%;border:%?1000?% solid rgba(0,0,0,.5)}.content .camera[data-v-66d41d42]{width:100%;height:100%;border-top:%?200?% solid #000;border-bottom:%?200?% solid #000;box-sizing:border-box}.content .camera-tip[data-v-66d41d42]{position:absolute;bottom:%?400?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);color:#fff}',""]),t.exports=a},ea6c:function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){}));var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"tn-custom-nav-bar-class tn-custom-nav-bar",style:[t.navBarStyle]},[e("v-uni-view",{staticClass:"tn-custom-nav-bar__bar",class:[t.barClass],style:[t.barStyle]},[t.isBack?e("v-uni-view",[t.customBack?e("v-uni-view",[e("v-uni-view",{style:{width:t.customBackStyleInfo.width+"px",height:t.customBackStyleInfo.height+"px",marginLeft:t.customBackStyleInfo.left+"px"}},[t._t("back")],2)],1):e("v-uni-view",{staticClass:"tn-custom-nav-bar__bar__action",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handlerBack.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"tn-custom-nav-bar__bar__action--nav-back",class:["tn-icon-"+t.backIcon]}),t.backTitle?e("v-uni-text",{staticClass:"tn-custom-nav-bar__bar__action--nav-back-text"},[t._v(t._s(t.backTitle))]):t._e()],1)],1):t._e(),e("v-uni-view",{staticClass:"tn-custom-nav-bar__bar__content",style:[t.contentStyle]},[t._t("default")],2),e("v-uni-view",[t._t("right")],2)],1)],1)},i=[]}}]);