(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["homePages/Strategy/Strategy"],{"104e":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={tnNavBar:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-nav-bar/tn-nav-bar")]).then(n.bind(null,"aa86"))},uniList:function(){return n.e("uni_modules/uni-list/components/uni-list/uni-list").then(n.bind(null,"6207"))},uniListItem:function(){return n.e("uni_modules/uni-list/components/uni-list-item/uni-list-item").then(n.bind(null,"243c"))},uTag:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-tag/u-tag")]).then(n.bind(null,"287f"))},uParse:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-parse/u-parse")]).then(n.bind(null,"03f4"))},uDivider:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-divider/u-divider")]).then(n.bind(null,"a923"))},tnEmpty:function(){return n.e("tuniao-ui/components/tn-empty/tn-empty").then(n.bind(null,"c9e6"))},tnTag:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-tag/tn-tag")]).then(n.bind(null,"5b3c"))},tnAvatar:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-avatar/tn-avatar")]).then(n.bind(null,"4693"))},uModal:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-modal/u-modal")]).then(n.bind(null,"8d90"))},uOverlay:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-overlay/u-overlay")]).then(n.bind(null,"a0b9"))},"u-Textarea":function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u--textarea/u--textarea")]).then(n.bind(null,"42d9"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"6545"))},tnPopup:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-popup/tn-popup")]).then(n.bind(null,"3a3d"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"41d2"))},tnButton:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-button/tn-button")]).then(n.bind(null,"e6e0"))},"u-Input":function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u--input/u--input")]).then(n.bind(null,"9231"))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"cc7a"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.commentsList.length),o=e.__map(e.commentsList,(function(t,n){var o=e.__get_orig(t),r=e.handlePublishTimeDesc(t.createTime),i=e.__map(t.children,(function(t,n){var o=e.__get_orig(t),r=e.handlePublishTimeDesc(t.createTime);return{$orig:o,m1:r}}));return{$orig:o,m0:r,l0:i}}));e._isMounted||(e.e0=function(t){e.delShow=!1}),e.$mp.data=Object.assign({},{$root:{g0:n,l1:o}})},i=[]},"5d35":function(e,t,n){},"79f5":function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("2eee")),i=o(n("c973")),u={data:function(){return{content:"",articleInfo:"",show:!1,delShow:!1,strategyId:"",commentCount:0,commentsList:[],liked:!1,blogData:"",browse:0,id:0,reportList:[{id:1,backgroundColor:"#fffef9",title:"谩骂攻击"},{id:2,backgroundColor:"#fffef9",title:"色情低俗"},{id:3,backgroundColor:"#fffef9",title:"网络暴力"},{id:4,backgroundColor:"#fffef9",title:"违法违规"},{id:5,backgroundColor:"#fffef9",title:"政治敏感"},{id:6,backgroundColor:"#fffef9",title:"垃圾广告"},{id:7,backgroundColor:"#fffef9",title:"危害人身安全"},{id:8,backgroundColor:"#fffef9",title:"未成年相关"},{id:9,backgroundColor:"#fffef9",title:"其他"}],loginUserId:"",placeholder:"请输入你想说的吧...",longitude:"",delId:"",latitude:"",comment:"",commentsForm:{},showReport:!1,isFollow:!1,blogUserId:""}},created:function(){e.getLocation({type:"wgs84",altitude:!0,success:function(e){_this.longitude=e.longitude,_this.latitude=e.latitude}})},onLoad:function(t){this.strategyId=t.id,this.getStrategy(t.id),this.getComments(),this.queryBrowse(),this.loginUserId=e.getStorageSync("userId")},methods:{goFollow:function(){var t=this;return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("token")){n.next=4;break}return e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("亲，先登录哦~"),n.abrupt("return");case 4:e.$http.put("/follow/"+t.blogUserId+"/"+!t.isFollow).then((function(){e.showToast({title:t.isFollow?"已取消关注":"关注成功",duration:3e3}),t.isFollow=!t.isFollow,setTimeout((function(){t.isFollowed()}),1200)}));case 5:case"end":return n.stop()}}),n)})))()},isFollowed:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get("/follow/or/not?followUserId="+t.blogUserId);case 2:if(o=n.sent,i=o.data,1!==i.code){n.next=8;break}t.isFollow=i.data,n.next=9;break;case 8:return n.abrupt("return",e.$showMsg());case 9:case"end":return n.stop()}}),n)})))()},goLiked:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("token")){n.next=4;break}return e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("亲，先登录哦~"),n.abrupt("return");case 4:return n.next=6,e.$http.put("/blog/like?id="+t.strategyId);case 6:o=n.sent,i=o.data,1===i.code?(t.getStrategy(),e.showToast({title:t.liked?"取消点赞成功~":"点赞成功~",icon:"success",duration:1500})):e.showToast({title:"点赞失败~",icon:"error"});case 9:case"end":return n.stop()}}),n)})))()},openDelShow:function(e){this.delId=e,this.delShow=!0},delComment:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.delete("/comments/delComment?commentId="+t.delId);case 2:o=n.sent,i=o.data,1===i.code?(t.getComments(),e.showToast({title:"删除评论成功",icon:"success"}),t.delShow=!1):e.showToast({title:"删除评论失败",icon:"error"});case 5:case"end":return n.stop()}}),n)})))()},reply:function(t,n){if(!e.getStorageSync("token"))return e.navigateTo({url:"/pages/login/login?index=1"}),void e.$showMsg("亲，先登录哦~");this.placeholder="回复 @"+t,this.commentsForm={content:this.comment,foreignId:this.strategyId,target:t,parentId:n,longitude:this.longitude,latitude:this.latitude},this.show=!0},publishComment:function(){var t=this;return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("token")){n.next=4;break}return e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("亲，先登录哦~"),n.abrupt("return");case 4:t.commentsForm={content:t.comment,foreignId:t.strategyId,longitude:t.longitude,latitude:t.latitude},t.show=!0;case 6:case"end":return n.stop()}}),n)})))()},saveReply:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(""!==t.comment){n.next=3;break}return e.showToast({title:"亲，请输入评论内容~",icon:"error"}),n.abrupt("return");case 3:return t.commentsForm.content=t.comment,n.next=6,e.$http.post("/comments/save",t.commentsForm);case 6:o=n.sent,i=o.data,1===i.code?(e.showToast({title:"回复成功~",icon:"success"}),t.show=!1,t.comment="",t.getComments(),e.$showMsg("评论成功~")):e.$showMsg(i.msg);case 9:case"end":return n.stop()}}),n)})))()},queryBrowse:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.getStorageSync("userId")?t.id=e.getStorageSync("userId"):t.id=0,n.next=3,e.$http.get("/blog/queryBrowse?blogId="+t.strategyId+"&id="+t.id);case 3:o=n.sent,i=o.data,t.browse=i.data.browse.toString();case 6:case"end":return n.stop()}}),n)})))()},closeShow:function(){this.placeholder="亲,请输入你想说的吧...",this.show=!1,this.comment=""},goUserHome:function(t){e.navigateTo({url:"/searchPages/userHome?userId="+t})},closeshowReport:function(){for(var e=0;e<this.reportList.length;e++)this.reportList[e].backgroundColor="#fffef9"},selectReports:function(e){"#fffef9"===this.reportList[e].backgroundColor?this.reportList[e].backgroundColor="#fe3157":this.reportList[e].backgroundColor="#fffef9"},submitReport:function(){var t=this;if(!e.getStorageSync("token"))return e.navigateTo({url:"/pages/login/login?index=1"}),void e.$showMsg("亲，先登录才能举报哦~");this.reportList.map((function(e){return e.backgroundColor})).includes("#fe3157")?(e.showToast({title:"感谢您的举报~",icon:"success"}),setTimeout((function(){t.showReport=!1}),1e3)):e.$showMsg("亲，请选择举报原因！")},report:function(){this.showReport=!0},likeComment:function(t,n){var o=this;return(0,i.default)(r.default.mark((function n(){var i,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.put("/comments/likeComment/"+t);case 2:i=n.sent,u=i.data,1===u.code?o.getComments():(e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("请先登录后在操作哦！~"));case 5:case"end":return n.stop()}}),n)})))()},getComments:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get("/comments/getComments?foreignId="+t.strategyId);case 2:if(o=n.sent,i=o.data,1!==i.code){n.next=10;break}t.commentsList=i.data.comments,t.commentCount=i.data.count.toString(),t.commentsList.createTime=t.handlePublishTimeDesc(i.data.comments.createTime),n.next=11;break;case 10:return n.abrupt("return",e.$showMsg());case 11:case"end":return n.stop()}}),n)})))()},handlePublishTimeDesc:function(e){var t=new Date,n=new Date(e),o=t.getTime()-n.getTime(),r=Math.floor(o/6048e5),i=Math.floor(o/864e5),u=Math.floor(o/36e5),a=Math.floor(o/6e4);return r>0?e:i<7&&i>0?i+"天前":u<24&&u>0?u+"小时前":a+"分钟前"},getStrategy:function(t){var n=this;return(0,i.default)(r.default.mark((function t(){var o,i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/blog/queryBlogById?id="+n.strategyId);case 2:o=t.sent,i=o.data,1===i.code&&(n.articleInfo=i.data,n.blogData=i.data,n.blogUserId=i.data.userId,n.liked=i.data.isLike,n.isFollowed());case 5:case"end":return t.stop()}}),t)})))()},cancle:function(){e.navigateBack()}}};t.default=u}).call(this,n("543d")["default"])},8498:function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("1827");o(n("66fd"));var r=o(n("e7ac"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},9273:function(e,t,n){"use strict";n.r(t);var o=n("79f5"),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},b128:function(e,t,n){"use strict";var o=n("5d35"),r=n.n(o);r.a},e7ac:function(e,t,n){"use strict";n.r(t);var o=n("104e"),r=n("9273");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("b128");var u=n("f0c5"),a=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,"4500ace7",null,!1,o["a"],void 0);t["default"]=a.exports}},[["8498","common/runtime","common/vendor"]]]);