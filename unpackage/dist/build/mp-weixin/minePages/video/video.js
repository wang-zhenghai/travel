(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["minePages/video/video"],{6099:function(e,t,n){"use strict";var o=n("d9ee"),i=n.n(o);i.a},"7ddb":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("1827");o(n("66fd"));var i=o(n("df15"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"8e2c":function(e,t,n){"use strict";n.r(t);var o=n("9cb6"),i=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},"9cb6":function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("2eee")),r=o(n("c973")),u=(n("88ff"),{data:function(){return{videoId:"",color:"#fe3157",color1:"#ffffff",userComment:"",height:800,showReport:!1,reportList:[{id:1,backgroundColor:"#fffef9",title:"谩骂攻击"},{id:2,backgroundColor:"#fffef9",title:"色情低俗"},{id:3,backgroundColor:"#fffef9",title:"网络暴力"},{id:4,backgroundColor:"#fffef9",title:"违法违规"},{id:5,backgroundColor:"#fffef9",title:"政治敏感"},{id:6,backgroundColor:"#fffef9",title:"垃圾广告"},{id:7,backgroundColor:"#fffef9",title:"危害人身安全"},{id:8,backgroundColor:"#fffef9",title:"未成年相关"},{id:9,backgroundColor:"#fffef9",title:"其他"}],target:"",placeholder:"",parentId:"",commentList:[],videoInfo:{},commentTotal:0,userId:e.getStorageSync("userId"),videoUserId:"",showCommentList:!1,showSubmitPopup:!1,showReplyPopup:!1,ip:"",longitude:"",latitude:""}},watch:{userComment:function(e,t){e.length>85&&(this.height=1e3),e.length>100&&(this.height=1025)}},onShow:function(){this.getVideoInfo()},methods:{closeshowReport:function(){for(var e=0;e<this.reportList.length;e++)this.reportList[e].backgroundColor="#fffef9"},selectReports:function(e){"#fffef9"===this.reportList[e].backgroundColor?this.reportList[e].backgroundColor="#fe3157":this.reportList[e].backgroundColor="#fffef9"},goUserHome:function(t){e.navigateTo({url:"/searchPages/userHome?userId="+t})},report:function(){this.showReport=!0},submitReport:function(){var t=this;if(!e.getStorageSync("token"))return e.navigateTo({url:"/pages/login/login?index=1"}),void e.$showMsg("亲，先登录才能举报哦~");this.reportList.map((function(e){return e.backgroundColor})).includes("#fe3157")?(e.showToast({title:"感谢您的举报~",icon:"success"}),setTimeout((function(){t.showReport=!1}),1e3)):e.$showMsg("亲，请选择举报原因！")},sendComment:function(){var t=this;return(0,r.default)(i.default.mark((function n(){var o,r,u;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o={content:t.userComment.trim(),foreignId:t.videoId,longitude:t.longitude,latitude:t.latitude},n.next=3,e.$http.post("/video/comments/saveVideoComment",o);case 3:r=n.sent,u=r.data,1===u.code?(t.commentTotal++,t.loadComment(),t.showSubmitPopup=!1):e.$showMsg(u.msg);case 6:case"end":return n.stop()}}),n)})))()},sendReplyComment:function(){var t=this;return(0,r.default)(i.default.mark((function n(){var o,r,u;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o={content:t.userComment.trim(),foreignId:t.videoId,target:t.target,parentId:t.parentId,longitude:t.longitude,latitude:t.latitude},n.next=3,e.$http.post("/video/comments/saveVideoComment",o);case 3:r=n.sent,u=r.data,1===u.code?(t.commentTotal++,t.loadComment(),t.showReplyPopup=!1):e.$showMsg(u.msg);case 6:case"end":return n.stop()}}),n)})))()},openSubmitPopup:function(){},closeSubmitPopup:function(){this.userComment="",this.height=700},closeReplyPopup:function(){this.userComment="",this.height=700},submitComment:function(){var e=this;this.showSubmitPopup=!0,this.$nextTick((function(){e.$refs.textarea.focus()}))},reply:function(e,t){var n=this;return(0,r.default)(i.default.mark((function o(){return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n.placeholder="回复 @"+e,n.$nextTick((function(){n.target=e,n.parentId=t})),n.showReplyPopup=!0;case 3:case"end":return o.stop()}}),o)})))()},loadComment:function(){var t=this;return(0,r.default)(i.default.mark((function n(){var o,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get("/video/comments/getVideoCommentsList/"+t.videoId);case 2:o=n.sent,r=o.data,1===r.code?t.commentList=r.data:e.$showMsg("获取评论数据失败！");case 5:case"end":return n.stop()}}),n)})))()},handlePublishTimeDesc:function(e){var t=new Date,n=new Date(e),o=t.getTime()-n.getTime(),i=Math.floor(o/6048e5),r=Math.floor(o/864e5),u=Math.floor(o/36e5),a=Math.floor(o/6e4);return i>0?e:r<7&&r>0?r+"天前":u<24&&u>0?u+"小时前":a+"分钟前"},likeComment:function(t,n){var o=this;return(0,r.default)(i.default.mark((function n(){var r,u;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.put("/video/comments/like/"+t);case 2:r=n.sent,u=r.data,1===u.code?o.loadComment():(e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("请先登录后在操作哦！~"));case 5:case"end":return n.stop()}}),n)})))()},closeComment:function(){this.getVideoInfo()},openComment:function(e,t,n){var o=this;this.$nextTick((function(){o.videoId=e,o.videoUserId=n})),this.showCommentList=!0},likeVideo:function(t,n){var o=this;return(0,r.default)(i.default.mark((function r(){var u,a;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$http.put("/video/like/"+t);case 2:u=i.sent,a=u.data,1===a.code?n?(o.getVideoInfo(),e.showToast({title:"取消点赞成功~",icon:"success",duration:500})):(o.getVideoInfo(),e.showToast({title:"点赞成功~",icon:"success",duration:500})):(e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("请先登录后在操作哦！~"));case 5:case"end":return i.stop()}}),r)})))()},collectionVideo:function(t,n){var o=this;return(0,r.default)(i.default.mark((function r(){var u,a;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$http.put("/video/collection/"+t);case 2:u=i.sent,a=u.data,1===a.code?n?(o.getVideoInfo(),e.showToast({title:"取消收藏成功~",icon:"success",duration:600})):(o.getVideoInfo(),e.showToast({title:"收藏成功~",icon:"success",duration:600})):(e.navigateTo({url:"/pages/login/login?index=1"}),e.$showMsg("请先登录后在操作哦！~"));case 5:case"end":return i.stop()}}),r)})))()},goBack:function(){e.navigateBack()},getVideoInfo:function(){var t=this;return(0,r.default)(i.default.mark((function n(){var o,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get("/video/getVideoInfo/"+t.videoId);case 2:o=n.sent,r=o.data,1===r.code?(t.videoInfo=r.data,t.commentTotal=r.data.comment):(e.navigateBack(),e.$showMsg("视频已被删除啦！"));case 5:case"end":return n.stop()}}),n)})))()}},created:function(){var t=this;e.getLocation({type:"wgs84",altitude:!0,success:function(e){t.longitude=e.longitude,t.latitude=e.latitude}})},onLoad:function(e){this.videoId=e.videoId,this.getVideoInfo()}});t.default=u}).call(this,n("543d")["default"])},d9ee:function(e,t,n){},df15:function(e,t,n){"use strict";n.r(t);var o=n("f4b4"),i=n("8e2c");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("6099");var u=n("f0c5"),a=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,"59cfc556",null,!1,o["a"],void 0);t["default"]=a.exports},f4b4:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var o={tnNavBar:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-nav-bar/tn-nav-bar")]).then(n.bind(null,"aa86"))},tnAvatar:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-avatar/tn-avatar")]).then(n.bind(null,"4693"))},tnPopup:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-popup/tn-popup")]).then(n.bind(null,"3a3d"))},tnEmpty:function(){return n.e("tuniao-ui/components/tn-empty/tn-empty").then(n.bind(null,"c9e6"))},tnTag:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-tag/tn-tag")]).then(n.bind(null,"5b3c"))},"u-Input":function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u--input/u--input")]).then(n.bind(null,"9231"))},"u-Textarea":function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u--textarea/u--textarea")]).then(n.bind(null,"42d9"))},tnButton:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-button/tn-button")]).then(n.bind(null,"e6e0"))},uLine:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-line/u-line")]).then(n.bind(null,"41d2"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.videoInfo.liked>9999&&e.videoInfo.liked<99999?Math.floor(e.videoInfo.liked/1e3):null),o=e.videoInfo.liked>99999?Math.floor(e.videoInfo.liked/1e3):null,i=e.videoInfo.comment>9999&&e.videoInfo.comment<99999?Math.floor(e.videoInfo.comment/1e3):null,r=e.videoInfo.comment>99999?Math.floor(e.videoInfo.comment/1e3):null,u=e.videoInfo.collection>9999&&e.videoInfo.collection<99999?Math.floor(e.videoInfo.collection/1e3):null,a=e.videoInfo.collection>99999?Math.floor(e.videoInfo.collection/1e3):null,c=e.commentList.length,s=e.__map(e.commentList,(function(t,n){var o=e.__get_orig(t),i=e.handlePublishTimeDesc(t.createTime),r=e.__map(t.children,(function(t,n){var o=e.__get_orig(t),i=e.handlePublishTimeDesc(t.createTime);return{$orig:o,m1:i}}));return{$orig:o,m0:i,l0:r}})),d=e.userComment?e.userComment.length:null,l=e.userComment?e.userComment.length:null;e.$mp.data=Object.assign({},{$root:{g0:n,g1:o,g2:i,g3:r,g4:u,g5:a,g6:c,l1:s,g7:d,g8:l}})},r=[]}},[["7ddb","common/runtime","common/vendor"]]]);