(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["minePages/face-authentication/face-authentication"],{"153d":function(t,e,a){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{tipsText:"",index:0}},onLoad:function(t){this.index=t.index,this.initData()},methods:{initData:function(){var e=this;t.initFaceDetect(),e.cameraEngine=t.createCameraContext();var a=e.cameraEngine.onCameraFrame((function(n){t.faceDetect({frameBuffer:n.data,width:n.width,height:n.height,enablePoint:!0,enableConf:!0,enableAngle:!0,enableMultiFace:!0,success:function(t){var i=t.faceInfo[0];if(-1!=t.x&&-1!=t.y||(e.tipsText="请将人脸放入取景框中",e.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/e37ef752-539b-49b7-94ea-1720f70fd390.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)),t.faceInfo.length>1)e.tipsText="请保证只有一个人";else{var c=i.angleArray,o=c.pitch,s=c.roll,u=c.yaw;if(Math.abs(o)>=.5||Math.abs(s)>=.5||Math.abs(u)>=.5)e.tipsText="请平视摄像头";else if(i.x<(n.width-150)/2||i.x>(n.width-150)/2+150||i.y<(n.height-150)/2||i.y>(n.height-150)/2+150)e.tipsText="请将人脸对准中心位置",e.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/39c7a4ca-6697-471e-872b-581b58dcd92c.mp3"),a.stop(),setTimeout((function(){a.start()}),2200);else{if(!(i.confArray.global<=.8||i.confArray.leftEye<=.8||i.confArray.mouth<=.8||i.confArray.nose<=.8||i.confArray.rightEye<=.8))return a.stop(),e.tipsText="即将拍照，请保持！",e.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/6d86c4b4-2d48-4eb8-900e-e5b2f7660f0f.mp3"),void setTimeout((function(){e.handleTakePhotoClick()}),3e3);e.tipsText="请勿遮挡五官",e.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/45edf2b9-5363-478b-9a2e-dc5cd6307596.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)}}},fail:function(t){-1==t.x||-1==t.y?(e.tipsText="请将人脸放入取景框中",e.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/e37ef752-539b-49b7-94ea-1720f70fd390.mp3"),a.stop(),setTimeout((function(){a.start()}),2200)):e.tipsText=t.errMsg||"网络错误，请退出页面重试"}})}));a.start()},handleTakePhotoClick:function(){var t=this;this.tipsText="人脸正在上传...",this.cameraEngine.takePhoto({quality:"low",success:function(e){var n=e.tempImagePath;a.uploadFile({url:"https://www.wangzh.work/upload",filePath:n,name:"file",success:function(e){var n=JSON.parse(e.data).data,i={imageUrl:n};a.$http.post("/face/addFaceAuthenticationInfo",i),t.tipsText="人脸认证成功",t.ScanAudio("https://wangzhenghai-oss.oss-cn-hangzhou.aliyuncs.com/9e06868c-95f6-401d-bc36-f4b5bd5282ee.mp3"),setTimeout((function(){a.navigateBack()}),2e3)}})}}),a.getSetting({success:function(e){e.authSetting["scope.camera"]||(t.isAuthCamera=!1,a.openSetting({success:function(e){e.authSetting["scope.camera"]&&(t.isAuthCamera=!0)}}))}})}}};e.default=n}).call(this,a("bc2e")["default"],a("543d")["default"])},3806:function(t,e,a){"use strict";a.r(e);var n=a("153d"),i=a.n(n);for(var c in n)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(c);e["default"]=i.a},"56ac":function(t,e,a){},a76f:function(t,e,a){"use strict";a.r(e);var n=a("ec90"),i=a("3806");for(var c in i)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(c);a("ac9d");var o=a("f0c5"),s=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"880ccefa",null,!1,n["a"],void 0);e["default"]=s.exports},a92b:function(t,e,a){"use strict";(function(t,e){var n=a("4ea4");a("1827");n(a("66fd"));var i=n(a("a76f"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(i.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},ac9d:function(t,e,a){"use strict";var n=a("56ac"),i=a.n(n);i.a},ec90:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return c})),a.d(e,"a",(function(){return n}));var n={tnNavBar:function(){return Promise.all([a.e("common/vendor"),a.e("tuniao-ui/components/tn-nav-bar/tn-nav-bar")]).then(a.bind(null,"aa86"))}},i=function(){var t=this.$createElement;this._self._c},c=[]}},[["a92b","common/runtime","common/vendor"]]]);