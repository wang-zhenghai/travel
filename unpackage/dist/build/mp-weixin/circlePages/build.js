(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["circlePages/build"],{"0938":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={tnNavBar:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-nav-bar/tn-nav-bar")]).then(n.bind(null,"aa86"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"2f48"))},uTag:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-tag/u-tag")]).then(n.bind(null,"287f"))},tnPopup:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-popup/tn-popup")]).then(n.bind(null,"3a3d"))},tnInput:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-input/tn-input")]).then(n.bind(null,"c3f9"))},tnButton:function(){return Promise.all([n.e("common/vendor"),n.e("tuniao-ui/components/tn-button/tn-button")]).then(n.bind(null,"e6e0"))},uOverlay:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-overlay/u-overlay")]).then(n.bind(null,"a0b9"))},tnCircleProgress:function(){return n.e("tuniao-ui/components/tn-circle-progress/tn-circle-progress").then(n.bind(null,"1b71"))}},a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.seletedTagList.length),o=t.tagList.length;t._isMounted||(t.e0=function(e){t.show=!0},t.e1=function(e){t.show=!1},t.e2=function(e){t.show=!0}),t.$mp.data=Object.assign({},{$root:{g0:n,g1:o}})},i=[]},"0fe6":function(t,e,n){"use strict";n.r(e);var o=n("7fed"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},"12a3":function(t,e,n){"use strict";n.r(e);var o=n("0938"),a=n("0fe6");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("a1eb");var u=n("f0c5"),s=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"59253fb8",null,!1,o["a"],void 0);e["default"]=s.exports},6106:function(t,e,n){},"7fed":function(t,e,n){"use strict";(function(t){var o=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("2eee")),i=o(n("c973")),u=o(n("88ff")),s={name:"TemplateBuild",mixins:[u.default],data:function(){return{progress:!1,percent:20,tagList:[],uploadFilePath:"",title:"",content:"",tempPath:"",uploadShow:!0,showTag:!0,videoShow:!1,show:!1,seletedTagList:[],tag:""}},watch:{seletedTagList:function(e,n){e.length>5&&(t.$showMsg("亲，最多可以添加5个标签哦~"),this.seletedTagList.splice(5))}},methods:{getTagList:function(){var e=this;return(0,i.default)(a.default.mark((function n(){var o,i;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(""===e.content){n.next=6;break}return n.next=3,t.$http.get("/api/getTagList?text="+e.content);case 3:o=n.sent,i=o.data,1===i.code&&(e.tagList=i.data);case 6:case"end":return n.stop()}}),n)})))()},confirmTag:function(){if(""!==this.tag){var e=this.seletedTagList.indexOf(this.tag);-1!=e?(t.$showMsg("已存在相同标签啦！"),this.tag=""):(this.seletedTagList.push(this.tag),this.show=!1,this.tag="",t.$showMsg("添加成功！"))}else t.$showMsg("自定义标签不能为空")},selectTag:function(e){var n=this.seletedTagList.indexOf(e);-1!=n?t.$showMsg("相同标签只能存在一个哦"):this.seletedTagList.push(e)},close:function(t){var e=this.seletedTagList.indexOf(t);this.seletedTagList.splice(e,1)},delTagList:function(){this.seletedTagList=[]},submit:function(){var e=this;return(0,i.default)(a.default.mark((function n(){var o,i,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.getStorageSync("token")){n.next=4;break}return t.navigateTo({url:"/pages/login/login"}),t.$showMsg("亲，先登录才能发表哦~"),n.abrupt("return");case 4:if(""!==e.title){n.next=7;break}return t.$showMsg("亲,视频标题不能为空哦~"),n.abrupt("return");case 7:if(""!==e.content){n.next=10;break}return t.$showMsg("亲,视频内容不能为空哦~"),n.abrupt("return");case 10:if(""!==e.uploadFilePath){n.next=13;break}return t.$showMsg("亲,请上传你的视频~"),n.abrupt("return");case 13:if(""!==e.title||""!=e.content||""!==e.uploadFilePath){n.next=16;break}return t.$showMsg("亲,标题和内容与视频都不能为空哦~"),n.abrupt("return");case 16:return o=e.seletedTagList.join("#"),n.next=19,t.$http.post("/video/save",{title:e.title,url:e.uploadFilePath,content:e.content,tag:o});case 19:i=n.sent,u=i.data,1===u.code?(e.progress=!0,clearInterval(e.timer),e.timer=setInterval((function(){e.percent+=20,100===e.percent&&(e.progress=!1)}),450),setTimeout((function(){t.navigateBack()}),3e3),e.uploadFilePath="",e.title="",e.content="",e.seletedTagList=[],e.videoShow=!1,e.uploadShow=!0):t.$showMsg(u.msg);case 22:case"end":return n.stop()}}),n)})))()},afterRead:function(e){var n=this,o=t.uploadFile({header:{"Content-Type":"multipart/form-data"},url:"https://www.wangzh.work/upload",filePath:e.file.url,name:"file",success:function(t){var e=JSON.parse(t.data);n.uploadFilePath=e.data,n.uploadShow=!1,n.videoShow=!0},fail:function(e){console.log(e),t.navigateTo({url:"/pages/login/login"}),t.$showMsg("登录失效,请重新登录")}});o.onProgressUpdate((function(e){t.showLoading({title:"已上传"+e.progress+"%"}),100===e.progress&&setTimeout((function(){t.hideLoading(),t.$showMsg("上传视频成功~")}),2e3)}))},clear:function(){this.uploadFilePath="",this.videoShow=!1,this.uploadShow=!0},tn:function(e){t.navigateTo({url:e})}}};e.default=s}).call(this,n("543d")["default"])},"9ae4":function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("1827");o(n("66fd"));var a=o(n("12a3"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},a1eb:function(t,e,n){"use strict";var o=n("6106"),a=n.n(o);a.a}},[["9ae4","common/runtime","common/vendor"]]]);